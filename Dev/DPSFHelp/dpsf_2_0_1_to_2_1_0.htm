<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- saved from url=(0029)http://www.helpandmanual.com/ -->
<head>
   <title>DPSF 2.0.1 to 2.1.0</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
<script type="text/javascript" src="helpman_topicinit.js"></script>
<!-- Redirect browser to frame page if page is not in the content frame. -->
<script type="text/javascript">
<!--
if (location.search.lastIndexOf("toc=0")<=0) {
  if (parent.frames.length==0) { parent.location.href="index.html?dpsf_2_0_1_to_2_1_0.htm"; }
  else { parent.quicksync('a11.2'); }
}
//-->
</script>
<script type="text/javascript" src="highlight.js"></script></head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;" onload="highlight();">
<div id="hmpopupDiv" style="visibility:hidden; position:absolute; z-index:1000; "></div>


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#D0D0D0">
  <tr valign="middle">
    <td align="left">
      <p class="p_Heading1"><span class="f_Heading1">DPSF 2.0.1 to 2.1.0</span></p>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="introduction.htm">Top</a>&nbsp;
     <a href="dpsf_2_1_0_to_2_2_0.htm">Previous</a>&nbsp;
     <a href="dpsf_1_5_4_0_to_2_0_0_0.htm">Next</a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p><span style="font-size: 12pt; font-weight: bold;">1 - New Sprite 3D Billboard Particle System type added</span></p>
<p>&nbsp;</p>
<p>The new DefaultSprite3DBillboardParticleSystem is almost always faster (up to 50%) than the traditional DefaultTexturedQuad particle system that updates its particles to always face the camera (i.e. billboards). &nbsp;Unlike the Textured Quad particle systems though, the Sprite 3D Billboard Particle Systems always have their particles facing the camera, so if you require your particles to be oriented or rotate in all 3 dimensions, then you must still use a Textured Quad particle system.</p>
<p>&nbsp;</p>
<p><span style="font-size: 12pt; font-weight: bold;">1a - Converting a Textured Quad Particle System to a Sprite 3D Billboard Particle System</span></p>
<p>If you were using a billboarded Textured Quad particle system, you will likely want to change it to be a Sprite 3D Billboard particle system for better performance by doing the following:</p>
<p>&nbsp;</p>
<p style="background: #ffffff;"><span style="color: #000000;">- Change particle system class to inherit from the DefaultSprite3DBillboardParticleSystem instead of DefaultTexturedQuadParticleSystem.</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #0000ff;">class</span><span style="font-family: 'Consolas'; color: #000000;"> </span><span style="font-family: 'Consolas'; color: #2b91af;">FireParticleSystem</span><span style="font-family: 'Consolas'; color: #000000;"> : </span><span style="font-family: 'Consolas'; color: #2b91af;">DefaultTexturedQuadParticleSystem</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="color: #000000;">To:</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #0000ff;">class</span><span style="font-family: 'Consolas'; color: #000000;"> </span><span style="font-family: 'Consolas'; color: #2b91af;">FireParticleSystem</span><span style="font-family: 'Consolas'; color: #000000;"> : </span><span style="font-family: 'Consolas'; color: #2b91af;">DefaultSprite3DBillboardParticleSystem</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="color: #000000;">- Change particles to be of type DefaultSpriteParticle3DBillboardParticle instead of DefaultTexturedQuadParticle.</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #0000ff;">public</span><span style="font-family: 'Consolas'; color: #000000;"> </span><span style="font-family: 'Consolas'; color: #0000ff;">void</span><span style="font-family: 'Consolas'; color: #000000;"> InitializeParticleFireOnVerticalRing(</span><span style="font-family: 'Consolas'; color: #2b91af;">DefaultTexturedQuadParticle</span><span style="font-family: 'Consolas'; color: #000000;"> cParticle)</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="color: #000000;">To:</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #0000ff;">public</span><span style="font-family: 'Consolas'; color: #000000;"> </span><span style="font-family: 'Consolas'; color: #0000ff;">void</span><span style="font-family: 'Consolas'; color: #000000;"> InitializeParticleFireOnVerticalRing(</span><span style="font-family: 'Consolas'; color: #2b91af;">DefaultSprite3DBillboardParticle</span><span style="font-family: 'Consolas'; color: #000000;"> cParticle)</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="color: #000000;">- Initialize the particle system as a Sprite particle system instead of a Quad one.</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">InitializeTexturedQuadParticleSystem(cGraphicsDevice, cContentManager, 1000, 50000, UpdateVertexProperties, </span><span style="font-family: 'Consolas'; color: #a31515;">"Textures/Fire"</span><span style="font-family: 'Consolas'; color: #000000;">);</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="color: #000000;">To:</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">InitializeSpriteParticleSystem(cGraphicsDevice, cContentManager, 1000, 50000, </span><span style="font-family: 'Consolas'; color: #a31515;">"Textures/Fire"</span><span style="font-family: 'Consolas'; color: #000000;">);</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="color: #000000;">- Change particle orientation from using a Quaternion to just use a scalar value.</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">cParticle.Orientation = DPSF.</span><span style="font-family: 'Consolas'; color: #2b91af;">Orientation3D</span><span style="font-family: 'Consolas'; color: #000000;">.Rotate(</span><span style="font-family: 'Consolas'; color: #2b91af;">Matrix</span><span style="font-family: 'Consolas'; color: #000000;">.CreateRotationZ(RandomNumber.Between(0, </span><span style="font-family: 'Consolas'; color: #2b91af;">MathHelper</span><span style="font-family: 'Consolas'; color: #000000;">.TwoPi)), cParticle.Orientation);</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="color: #000000;">To:</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">cParticle.Rotation = RandomNumber.Between(0, </span><span style="font-family: 'Consolas'; color: #2b91af;">MathHelper</span><span style="font-family: 'Consolas'; color: #000000;">.TwoPi);</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="color: #000000;">- Change particle rotations from using Vector3s to just use scalar values.</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">InitialProperties.RotationMin = </span><span style="font-family: 'Consolas'; color: #2b91af;">Vector3</span><span style="font-family: 'Consolas'; color: #000000;">.Zero;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">InitialProperties.RotationMax.Z = </span><span style="font-family: 'Consolas'; color: #2b91af;">MathHelper</span><span style="font-family: 'Consolas'; color: #000000;">.TwoPi;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">InitialProperties.RotationalVelocityMin = </span><span style="font-family: 'Consolas'; color: #0000ff;">new</span><span style="font-family: 'Consolas'; color: #000000;"> </span><span style="font-family: 'Consolas'; color: #2b91af;">Vector3</span><span style="font-family: 'Consolas'; color: #000000;">(0, 0, -</span><span style="font-family: 'Consolas'; color: #2b91af;">MathHelper</span><span style="font-family: 'Consolas'; color: #000000;">.TwoPi);</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">InitialProperties.RotationalVelocityMax = </span><span style="font-family: 'Consolas'; color: #0000ff;">new</span><span style="font-family: 'Consolas'; color: #000000;"> </span><span style="font-family: 'Consolas'; color: #2b91af;">Vector3</span><span style="font-family: 'Consolas'; color: #000000;">(0, 0, </span><span style="font-family: 'Consolas'; color: #2b91af;">MathHelper</span><span style="font-family: 'Consolas'; color: #000000;">.TwoPi);</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="color: #000000;">To:</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">InitialProperties.RotationMin = 0;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">InitialProperties.RotationMax = </span><span style="font-family: 'Consolas'; color: #2b91af;">MathHelper</span><span style="font-family: 'Consolas'; color: #000000;">.TwoPi;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">InitialProperties.RotationalVelocityMin = -</span><span style="font-family: 'Consolas'; color: #2b91af;">MathHelper</span><span style="font-family: 'Consolas'; color: #000000;">.TwoPi;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">InitialProperties.RotationalVelocityMax = </span><span style="font-family: 'Consolas'; color: #2b91af;">MathHelper</span><span style="font-family: 'Consolas'; color: #000000;">.TwoPi;</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="color: #000000;">- Add Vector3 CameraPosition and override the SetCameraPosition() function to set it.</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">  &nbsp; &nbsp; &nbsp; </span><span style="font-family: 'Consolas'; color: #808080;">///</span><span style="font-family: 'Consolas'; color: #008000;"> </span><span style="font-family: 'Consolas'; color: #808080;">&lt;summary&gt;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">  &nbsp; &nbsp; &nbsp; </span><span style="font-family: 'Consolas'; color: #808080;">///</span><span style="font-family: 'Consolas'; color: #008000;"> Get / Set the Camera Position used by the particle system</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">  &nbsp; &nbsp; &nbsp; </span><span style="font-family: 'Consolas'; color: #808080;">///</span><span style="font-family: 'Consolas'; color: #008000;"> </span><span style="font-family: 'Consolas'; color: #808080;">&lt;/summary&gt;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">  &nbsp; &nbsp; &nbsp; </span><span style="font-family: 'Consolas'; color: #0000ff;">public</span><span style="font-family: 'Consolas'; color: #000000;"> </span><span style="font-family: 'Consolas'; color: #2b91af;">Vector3</span><span style="font-family: 'Consolas'; color: #000000;"> CameraPosition { </span><span style="font-family: 'Consolas'; color: #0000ff;">get</span><span style="font-family: 'Consolas'; color: #000000;">; </span><span style="font-family: 'Consolas'; color: #0000ff;">set</span><span style="font-family: 'Consolas'; color: #000000;">; }</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">  &nbsp; &nbsp; &nbsp; </span><span style="font-family: 'Consolas'; color: #808080;">///</span><span style="font-family: 'Consolas'; color: #008000;"> </span><span style="font-family: 'Consolas'; color: #808080;">&lt;summary&gt;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">  &nbsp; &nbsp; &nbsp; </span><span style="font-family: 'Consolas'; color: #808080;">///</span><span style="font-family: 'Consolas'; color: #008000;"> Sets the camera position.</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">  &nbsp; &nbsp; &nbsp; </span><span style="font-family: 'Consolas'; color: #808080;">///</span><span style="font-family: 'Consolas'; color: #008000;"> </span><span style="font-family: 'Consolas'; color: #808080;">&lt;/summary&gt;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">  &nbsp; &nbsp; &nbsp; </span><span style="font-family: 'Consolas'; color: #808080;">///</span><span style="font-family: 'Consolas'; color: #008000;"> </span><span style="font-family: 'Consolas'; color: #808080;">&lt;param name="cameraPosition"&gt;</span><span style="font-family: 'Consolas'; color: #008000;">The camera position.</span><span style="font-family: 'Consolas'; color: #808080;">&lt;/param&gt;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">  &nbsp; &nbsp; &nbsp; </span><span style="font-family: 'Consolas'; color: #0000ff;">public</span><span style="font-family: 'Consolas'; color: #000000;"> </span><span style="font-family: 'Consolas'; color: #0000ff;">override</span><span style="font-family: 'Consolas'; color: #000000;"> </span><span style="font-family: 'Consolas'; color: #0000ff;">void</span><span style="font-family: 'Consolas'; color: #000000;"> SetCameraPosition(</span><span style="font-family: 'Consolas'; color: #2b91af;">Vector3</span><span style="font-family: 'Consolas'; color: #000000;"> cameraPosition)</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">  &nbsp; &nbsp; &nbsp; {</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span style="font-family: 'Consolas'; color: #0000ff;">this</span><span style="font-family: 'Consolas'; color: #000000;">.CameraPosition = cameraPosition;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">  &nbsp; &nbsp; &nbsp; }</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="color: #000000;">- No more ColorBlendAmount parameter in the overridden SetEffectParameters() function since it doesn’t use the DPSFDefaultEffect (it uses the AlphaTestEffect) and ColorBlendAmount is only in the DPSFDefaultEffect. &nbsp;If you don’t want to tint the texture with a color at all (i.e. just use the texture with its original colors), then disable using Vertex Colors on the effect. Change:</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #0000ff;">protected</span><span style="font-family: 'Consolas'; color: #000000;"> </span><span style="font-family: 'Consolas'; color: #0000ff;">override</span><span style="font-family: 'Consolas'; color: #000000;"> </span><span style="font-family: 'Consolas'; color: #0000ff;">void</span><span style="font-family: 'Consolas'; color: #000000;"> SetEffectParameters()</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">{</span></p>
<p style="background: #ffffff;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="font-family: 'Consolas'; color: #0000ff;">base</span><span style="font-family: 'Consolas'; color: #000000;">.SetEffectParameters();</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">&nbsp;</span></p>
<p style="background: #ffffff;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="font-family: 'Consolas'; color: #008000;">// Specify to not use the Color component when drawing (Texture color is not tinted)</span></p>
<p style="background: #ffffff;"> &nbsp; &nbsp; &nbsp; &nbsp;<span style="font-family: 'Consolas'; color: #000000;">Effect.Parameters[</span><span style="font-family: 'Consolas'; color: #a31515;">"xColorBlendAmount"</span><span style="font-family: 'Consolas'; color: #000000;">].SetValue(0.0f);</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">}</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="color: #000000;">To:</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #0000ff;">protected</span><span style="font-family: 'Consolas'; color: #000000;"> </span><span style="font-family: 'Consolas'; color: #0000ff;">override</span><span style="font-family: 'Consolas'; color: #000000;"> </span><span style="font-family: 'Consolas'; color: #0000ff;">void</span><span style="font-family: 'Consolas'; color: #000000;"> InitializeRenderProperties()</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">{</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">   </span><span style="font-family: 'Consolas'; color: #0000ff;">base</span><span style="font-family: 'Consolas'; color: #000000;">.InitializeRenderProperties();</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">  &nbsp; </span><span style="font-family: 'Consolas'; color: #2b91af;">AlphaTestEffect</span><span style="font-family: 'Consolas'; color: #000000;"> effect = </span><span style="font-family: 'Consolas'; color: #0000ff;">this</span><span style="font-family: 'Consolas'; color: #000000;">.Effect </span><span style="font-family: 'Consolas'; color: #0000ff;">as</span><span style="font-family: 'Consolas'; color: #000000;"> </span><span style="font-family: 'Consolas'; color: #2b91af;">AlphaTestEffect</span><span style="font-family: 'Consolas'; color: #000000;">;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">  &nbsp; </span><span style="font-family: 'Consolas'; color: #0000ff;">if</span><span style="font-family: 'Consolas'; color: #000000;"> (effect != </span><span style="font-family: 'Consolas'; color: #0000ff;">null</span><span style="font-family: 'Consolas'; color: #000000;">)</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">  &nbsp; {</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">  &nbsp; &nbsp; &nbsp; </span><span style="font-family: 'Consolas'; color: #008000;">// Use the Texture's original colors</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">  &nbsp; &nbsp; &nbsp; effect.VertexColorEnabled = </span><span style="font-family: 'Consolas'; color: #0000ff;">false</span><span style="font-family: 'Consolas'; color: #000000;">;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">  &nbsp; }</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">}</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="color: #000000;">- Remove the UpdateParticleToFaceTheCamera EveryTime Event:</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">ParticleEvents.AddEveryTimeEvent(UpdateParticleToFaceTheCamera, 200);</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="color: #000000;">To (or just delete it):</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">//ParticleEvents.AddEveryTimeEvent(UpdateParticleToFaceTheCamera, 200);</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="line-height: 1.15; margin: 0px 0px 13px 0px;"><span style="color: #000000;">- &nbsp;Change fade-out to keep brighter colors. &nbsp;Because the AlphaTestEffect uses Premultiplied colors, once you start to fade colors out they appear darker. &nbsp;To help keep your particle colors brighter, you may not want them to be as faded out for most of their lifetime, so consider changing the EveryTime Event you are using to fade the particles out from:</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">UpdateParticleTransparencyToFadeOutUsingLerp</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="color: #000000;">To something like:</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">UpdateParticleTransparencyWithQuickFadeInAndQuickFadeOut</span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-size: 12pt; font-weight: bold;">2 - Changed particle system's IsInitialized() function into IsInitialized boolean property</span></p>
<p>&nbsp;</p>
<p>If the compiler complains that the function ".IsInitialized()" doesn't exist on your particle system, simply change it to ".IsInitialized".</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-size: 12pt; font-weight: bold;">3 - Drawing particles in properly depth-sorted order:</span></p>
<p>&nbsp;</p>
<p style="line-height: 1.15; margin: 0px 0px 13px 0px;"><span style="color: #000000;">Some particle systems don't look quite right unless their particles are drawn in the proper depth-sorted order. &nbsp;Particularly particles that have semi-transparent sections and are not using additive blending. &nbsp;To depth-sort your Quad or Sprite3DBillboard particles, first try (as shown in the DPSF Demo's FountainPS.cs):</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #0000ff;">protected</span><span style="font-family: 'Consolas'; color: #000000;"> </span><span style="font-family: 'Consolas'; color: #0000ff;">override</span><span style="font-family: 'Consolas'; color: #000000;"> </span><span style="font-family: 'Consolas'; color: #0000ff;">void</span><span style="font-family: 'Consolas'; color: #000000;"> InitializeRenderProperties()</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">{</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">  &nbsp; </span><span style="font-family: 'Consolas'; color: #0000ff;">base</span><span style="font-family: 'Consolas'; color: #000000;">.InitializeRenderProperties();</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">&nbsp;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">  &nbsp; </span><span style="font-family: 'Consolas'; color: #008000;">// Turn on depth buffer writing so particles are drawn in the correct order.</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">  &nbsp; </span><span style="font-family: 'Consolas'; color: #008000;">// This can cause clipping problems with some textures.</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">  &nbsp; RenderProperties.DepthStencilState = </span><span style="font-family: 'Consolas'; color: #2b91af;">DepthStencilState</span><span style="font-family: 'Consolas'; color: #000000;">.Default;</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">}</span></p>
<p style="line-height: 1.15; margin: 0px 0px 13px 0px;">&nbsp;</p>
<p style="line-height: 1.15; margin: 0px 0px 13px 0px;"><span style="color: #000000;">If it produces clipping problems with the texture you plan on using, then you instead will need to use the more expensive method of (as shown in DPSF Demo's StarPS.cs), which only sorts the particles in a single particle system:</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #008000;">// These textures contain both opaque and semi-transparent portions, so in order to get them drawn correctly (so that</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #008000;">// particles further away aren't drawn overtop of closer particles), we must sort the particles so that they are drawn </span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #008000;">// in the order of farthest from the camera to closest to the camera.</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #008000;">// These operations are expensive, so they should only be used if it is important that particles in front hide the particles behind them.</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">ParticleEvents.AddEveryTimeEvent(UpdateParticleDistanceFromCameraSquared);</span></p>
<p style="background: #ffffff;"><span style="font-family: 'Consolas'; color: #000000;">ParticleSystemEvents.AddEveryTimeEvent(UpdateParticleSystemToSortParticlesByDistanceFromCamera);</span></p>
<p style="background: #ffffff;"><span style="background-color: #ffffff;">&nbsp;</span></p>

</td></tr></table>

</body>
</html>
